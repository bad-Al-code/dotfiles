################################################################################
#                    Picom Configuration - Modern Setup
################################################################################

################################################################################
#                              Backend Settings
################################################################################

# Backend to use: "xrender" or "glx" (glx is better for performance)
backend = "glx";

# Enable/disable VSync
vsync = true;

# Try to detect WM windows and mark them as active
mark-wmwin-focused = true;

# Mark all non-WM windows as active
mark-ovredir-focused = true;

# Use EWMH _NET_WM_ACTIVE_WINDOW to determine which window is focused
use-ewmh-active-win = true;

# Detect rounded corners and treat them as rectangular
detect-rounded-corners = true;

# Detect _NET_WM_OPACITY on client windows
detect-client-opacity = true;

# Use damage information to help limit the area to paint
use-damage = true;

# Set the log level (trace, debug, info, warn, error)
log-level = "warn";

################################################################################
#                              GLX Backend
################################################################################

# GLX backend: Avoid using stencil buffer
glx-no-stencil = true;

# GLX backend: Avoid rebinding pixmap on window damage
glx-no-rebind-pixmap = true;

################################################################################
#                              Shadows
################################################################################

# Enable client-side shadows on windows
shadow = true;

# Shadow radius (pixels)
shadow-radius = 14;

# Shadow opacity
shadow-opacity = 0.3;

# Shadow offset X (pixels)
shadow-offset-x = -14;

# Shadow offset Y (pixels)
shadow-offset-y = -14;

# Shadow color (RGB format)
# shadow-red = 0.0;
# shadow-green = 0.0;
# shadow-blue = 0.0;

# Exclude conditions for shadows
shadow-exclude = [
    "name = 'Notification'",
    "class_g = 'Conky'",
    "class_g ?= 'Notify-osd'",
    "class_g = 'Cairo-clock'",
    "class_g = 'slop'",
    "class_g = 'Polybar'",
    "_GTK_FRAME_EXTENTS@:c",
    "_NET_WM_STATE@:32a *= '_NET_WM_STATE_HIDDEN'"
];

################################################################################
#                              Fading
################################################################################

# Fade windows in/out when opening/closing
fading = true;

# Opacity change between steps while fading in (0.01 - 1.0)
fade-in-step = 0.03;

# Opacity change between steps while fading out (0.01 - 1.0)
fade-out-step = 0.03;

# Time between steps in fade step (milliseconds)
fade-delta = 5;

# Exclude conditions for fading
fade-exclude = [];

################################################################################
#                              Transparency / Opacity
################################################################################

# Opacity of inactive windows (0.1 - 1.0)
# inactive-opacity = 0.95;

# Opacity of window titlebars and borders (0.1 - 1.0)
frame-opacity = 0.8;

# Let inactive opacity set by -i override the '_NET_WM_OPACITY' values of windows
inactive-opacity-override = false;

# Default opacity for active windows (0.1 - 1.0)
active-opacity = 1.0;

# Dim inactive windows (0.0 - 1.0)
inactive-dim = 0.0;

# Specify a list of opacity rules
opacity-rule = [
    "100:class_g = 'i3bar'",
    "100:class_g = 'i3-nagbar'",
    "100:name *= 'i3lock'",
    "100:class_g = 'Rofi'",
    "100:class_g = 'Polybar'",
    "100:class_g = 'firefox' && focused",
    "95:class_g = 'firefox' && !focused",
    "100:class_g = 'Brave-browser' && focused",
    "100:class_g = 'Brave-browser' && !focused",
    "100:class_g = 'Code' && focused",
    "100:class_g = 'Code' && !focused",
    "100:class_g = 'Alacritty' && focused",
    "100:class_g = 'Alacritty' && !focused",
    "100:class_g = 'Gnome-terminal' && focused",
    "100:class_g = 'Gnome-terminal' && !focused",
    "100:class_g = 'obsidian' && focused",
    "95:class_g = 'obsidian' && !focused",
    "100:class_g = 'Spotify'",
    "100:class_g = 'discord'",
    "100:class_g = 'Slack'",
    "100:class_g = 'TelegramDesktop'",
    "90:class_g = 'dropdown'",
    "100:_NET_WM_STATE@:32a *= '_NET_WM_STATE_FULLSCREEN'",
    "100:_NET_WM_STATE@:32a *= '_NET_WM_STATE_STICKY'"
];

################################################################################
#                              Blurring
################################################################################

# Blur background of semi-transparent / ARGB windows
blur-background = true;

# Blur method (dual_kawase is best for performance)
blur-method = "dual_kawase";

# Strength of the blur (1-20, higher is stronger)
blur-strength = 6;

# Blur background of windows when the window frame is not opaque
# blur-background-frame = true;

# Use fixed blur strength rather than adjusting according to window opacity
# blur-background-fixed = false;

# Exclude conditions for background blur
blur-background-exclude = [
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "_GTK_FRAME_EXTENTS@:c",
    "class_g = 'slop'",
    "class_g = 'Peek'",
    "name = 'screenshot'",
    "name = 'flameshot'"
];

################################################################################
#                              Rounded Corners
################################################################################

# Corner radius (pixels, 0 disables)
corner-radius = 8

# Exclude conditions for rounded corners
rounded-corners-exclude = [
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "class_g = 'Polybar'",
    "class_g = 'i3bar'",
    "_NET_WM_STATE@:32a *= '_NET_WM_STATE_FULLSCREEN'",
    "class_g = 'firefox' && argb",
    "class_g = 'Brave-browser' && argb"
];

################################################################################
#                              Window Type Settings
################################################################################

wintypes:
{
    tooltip = { 
        fade = true; 
        shadow = true; 
        opacity = 1.0; 
        focus = true; 
        full-shadow = false; 
    };
    dock = { 
        shadow = false; 
        clip-shadow-above = true; 
    };
    dnd = { 
        shadow = false; 
    };
    popup_menu = { 
        opacity = 1.0; 
        shadow = true; 
        fade = true; 
    };
    dropdown_menu = { 
        opacity = 1.0; 
        shadow = true; 
        fade = true; 
    };
    notification = { 
        shadow = true; 
        fade = true; 
    };
};

################################################################################
#                              Animations (picom-pijulius fork)
################################################################################

# Enable animations (only works with picom-pijulius or picom-animations fork)
# animations = true;
# animation-stiffness = 200;
# animation-window-mass = 0.5;
# animation-dampening = 20;
# animation-clamping = false;
# animation-for-open-window = "zoom";
# animation-for-unmap-window = "zoom";
# animation-for-workspace-switch-in = "slide-down";
# animation-for-workspace-switch-out = "slide-up";
